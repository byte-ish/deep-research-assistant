sequenceDiagram
    autonumber
    participant U as "User (Gradio UI)"
    participant RM as "ResearchManager (Orchestrator)"
    participant PA as "PlannerAgent (Search Planning)"
    participant SA as "SearchAgent (Web Search & Summaries)"
    participant WR as "WriterAgent (Report Generation)"
    participant EA as "EmailAgent (Send Report via Email)"
    participant WS as "Web Search Tool (Google/Bing)"
    participant SG as "SendGrid / Email Service"

    U->>RM: "Submit research query"
    RM->>PA: "Generate search plan"
    PA-->>RM: "Return planned search terms"
    RM->>SA: "Perform searches"
    SA->>WS: "Execute web searches"
    WS-->>SA: "Return raw search results"
    SA-->>RM: "Return summarized search results"
    RM->>WR: "Generate detailed report (Markdown + summary)"
    WR-->>RM: "Return report & summary"
    RM->>EA: "Send email with report"
    EA->>SG: "Send email via SendGrid"
    SG-->>EA: "Email delivery confirmation"
    EA-->>RM: "Email sent confirmation"
    RM-->>U: "Display final Markdown report in UI"